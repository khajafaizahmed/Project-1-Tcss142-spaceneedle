<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TCSS 142 ¬∑ Project 1 Strict Tester</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:
    radial-gradient(circle at 15% 20%, #1b3a6f 0%, transparent 40%),
    radial-gradient(circle at 85% 0%, #4c1d95 0%, transparent 45%),
    radial-gradient(circle at 50% 100%, #065f46 0%, transparent 45%),
    #020617;

  --card: rgba(17,24,39,.88);
  --border: rgba(148,163,184,.35);
  --text: #e5e7eb;
  --muted: #9ca3af;

  --green:#22c55e;
  --blue:#38bdf8;
  --purple:#a855f7;
  --yellow:#fbbf24;
  --red:#fb7185;

  --shadow: 0 25px 70px rgba(0,0,0,.75);
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  font-family:Inter,system-ui,sans-serif;
  color:var(--text);
  background:var(--bg);
}

/* DVD background */
.dvd-layer{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}
.dvd-x{
  position:absolute;
  width:110px;
  height:66px;
  animation:dvd-x 12s linear infinite alternate;
}
.dvd-y{
  width:110px;
  height:66px;
  animation:dvd-y 8s linear infinite alternate;
}
@keyframes dvd-x{
  from{transform:translateX(0)}
  to{transform:translateX(calc(100vw - 110px))}
}
@keyframes dvd-y{
  from{transform:translateY(0)}
  to{transform:translateY(calc(100vh - 66px))}
}

/* Layout */
.container{
  max-width:1250px;
  margin:28px auto;
  padding:16px;
  position:relative;
  z-index:1;
}

/* Header */
.header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom:18px;
}
.header h1{
  margin:0;
  font-size:34px;
  font-weight:700;
}
.header p{
  margin:6px 0 0;
  color:var(--muted);
  max-width:680px;
  font-size:14px;
}
.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  background:linear-gradient(90deg,#22c55e,#38bdf8);
  color:#020617;
  margin-bottom:8px;
}
.meta{
  text-align:right;
  font-size:12px;
  color:var(--muted);
}

/* Cards */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:18px;
  box-shadow:var(--shadow);
  backdrop-filter:blur(24px);
}

.grid{
  display:grid;
  grid-template-columns:420px 1fr;
  gap:18px;
}
@media(max-width:1000px){
  .grid{grid-template-columns:1fr}
}

/* How-to */
.howto h3{
  margin-top:0;
}
.howto li{
  margin-bottom:8px;
  font-size:14px;
}
.pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  margin-top:6px;
}
.pill.green{background:rgba(34,197,94,.15);color:var(--green)}
.pill.blue{background:rgba(56,189,248,.15);color:var(--blue)}
.pill.purple{background:rgba(168,85,247,.15);color:var(--purple)}

/* Editor */
.editor-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}
.status{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:12px;
  color:var(--green);
}
textarea{
  width:100%;
  height:260px;
  background:#020617;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  font-family:"JetBrains Mono",monospace;
  font-size:13px;
  resize:vertical;
}

/* Buttons */
.actions{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
}
button{
  border:none;
  border-radius:999px;
  padding:8px 18px;
  font-size:13px;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:6px;
}
.run{background:linear-gradient(90deg,#22c55e,#38bdf8);color:#020617}
.clear{background:#374151;color:var(--text)}
.secondary{background:#020617;color:var(--text);border:1px dashed var(--border)}

/* Output */
.output{
  margin-top:16px;
}
.result{
  border-radius:16px;
  padding:16px;
  margin-bottom:10px;
}
.ok{background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.4)}
.warn{background:rgba(251,191,36,.15);border:1px solid rgba(251,191,36,.4)}
.err{background:rgba(251,113,133,.15);border:1px solid rgba(251,113,133,.4)}
pre{
  white-space:pre;
  overflow:auto;
  font-family:"JetBrains Mono",monospace;
  font-size:12px;
}

/* Footer */
.footer{
  margin-top:20px;
  font-size:12px;
  color:var(--muted);
  text-align:center;
}
</style>
</head>

<body>

<div class="dvd-layer">
  <div class="dvd-x">
    <img class="dvd-y" src="https://vgmoose.bdns.dev/dvd_logo.png" alt="dvd">
  </div>
</div>

<div class="container">

  <div class="header">
    <div>
      <div class="badge">üóº SPACE NEEDLE TESTER</div>
      <h1>TCSS 142 ¬∑ Project 1 Strict Tester</h1>
      <p>
        Paste your full <b>Project1.java</b> and run the official strict tests.
        This compares your output line-by-line against the reference used for grading.
      </p>
    </div>
    <div class="meta">
      Class: TCSS 142 Programming Principles<br>
      Instructor: Prof. Xutong Liu<br>
      Built & maintained by TA Faiz Ahmed
    </div>
  </div>

  <div class="grid">

    <!-- HOW TO -->
    <div class="card howto">
      <h3>üß≠ How to use this tester</h3>
      <ol>
        <li>Paste the entire contents of <b>Project1.java</b>.</li>
        <li>Ensure the file declares <code>public class Project1</code>.</li>
        <li>Run tests and fix the <b>first mismatch</b> shown.</li>
        <li>Spacing and line count must match exactly.</li>
      </ol>

      <div class="pill green">‚úÖ Checks spacing & line count</div><br>
      <div class="pill blue">üîé Reports first mismatch only</div><br>
      <div class="pill purple">‚ö†Ô∏è Matches Canvas grading</div>
    </div>

    <!-- EDITOR -->
    <div class="card">
      <div class="editor-header">
        <h3>üìÑ Project1.java</h3>
        <div class="status">‚óè Ready to run</div>
      </div>

      <textarea id="code" placeholder="// Paste your full Project1.java here"></textarea>

      <div class="actions">
        <button class="run" onclick="runTests()">‚ñ∂ Run tests</button>
        <button class="clear" onclick="clearAll()">üßπ Clear input</button>
        <button class="secondary">‚å® Ctrl + Enter</button>
      </div>

      <div class="output" id="out">(waiting‚Ä¶)</div>
    </div>

  </div>

  <div class="footer">
    This page runs your code on the server using the official Project 1 reference.
    Passing here does not guarantee Canvas credit, but failures here will fail Canvas.
  </div>

</div>

<script>
const codeEl=document.getElementById("code");
const outEl=document.getElementById("out");

function esc(s){
  return (s||"").replace(/[&<>]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[c]));
}

async function runTests(){
  if(!codeEl.value.trim()){
    outEl.textContent="Paste Project1.java first.";
    return;
  }
  outEl.innerHTML="Running tests‚Ä¶";
  const r=await fetch("/run",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({code:codeEl.value})
  });
  render(await r.text());
}

function render(t){
  if(t.startsWith("STATUS:PASS")){
    outEl.innerHTML=`<div class="result ok">‚úÖ <b>PASS</b><br>Output matches exactly.</div>`;
    return;
  }
  if(t.startsWith("STATUS:COMPILE_ERROR")){
    outEl.innerHTML=`<div class="result err">‚ùå <b>Compilation error</b><pre>${esc(t)}</pre></div>`;
    return;
  }
  if(t.startsWith("STATUS:MISMATCH")||t.startsWith("STATUS:LINE_COUNT")){
    outEl.innerHTML=`<div class="result warn">‚ö†Ô∏è <b>Mismatch</b><pre>${esc(t)}</pre></div>`;
    return;
  }
  outEl.textContent=t;
}

function clearAll(){
  codeEl.value="";
  outEl.textContent="(waiting‚Ä¶)";
}

document.addEventListener("keydown",e=>{
  const meta=e.ctrlKey||e.metaKey;
  if(meta&&e.key==="Enter"){e.preventDefault();runTests();}
});
</script>

</body>
</html>
