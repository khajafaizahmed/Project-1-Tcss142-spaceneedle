<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>TCSS 142 · Project 1 Tester — Space Needle</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#050810;
  --card:rgba(17,24,39,.86);
  --border:rgba(148,163,184,.35);
  --text:#e5e7eb;
  --muted:#9ca3af;
  --mono:"JetBrains Mono",monospace;
  --ok:#2bd67b;
  --warn:#ffcc4d;
  --err:#ff5d5d;
  --shadow:0 22px 60px rgba(0,0,0,.75);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter,system-ui,sans-serif;
  color:var(--text);
  background:radial-gradient(circle at top,#181c3a 0%,var(--bg) 55%,#02040a 100%);
  cursor:none;
  overflow:hidden;
}

/* Aurora */
body::before{
  content:"";
  position:fixed;
  inset:-40%;
  background:
    radial-gradient(circle at 10% 20%,rgba(56,189,248,.2),transparent 45%),
    radial-gradient(circle at 80% 0%,rgba(168,85,247,.22),transparent 50%),
    radial-gradient(circle at 50% 100%,rgba(34,197,94,.2),transparent 55%);
  filter:blur(22px);
  animation:aurora 26s ease-in-out infinite alternate;
  z-index:-3;
}
@keyframes aurora{
  from{transform:translate(-3%,-2%) scale(1.03)}
  to{transform:translate(3%,2%) scale(1.06)}
}

/* Cursor */
.cursor{
  position:fixed;
  width:14px;
  height:14px;
  border-radius:50%;
  border:1px solid rgba(255,255,255,.6);
  transform:translate(-50%,-50%);
  pointer-events:none;
  z-index:80;
}
.cursor-glow{
  position:fixed;
  width:220px;
  height:220px;
  border-radius:50%;
  transform:translate(-50%,-50%);
  pointer-events:none;
  z-index:79;
  background:radial-gradient(circle,rgba(168,85,247,.22),rgba(56,189,248,.1),transparent 65%);
  mix-blend-mode:screen;
}

/* DVD */
#dvd{
  position:fixed;
  width:110px;
  height:46px;
  border-radius:14px;
  border:1px solid rgba(148,163,184,.35);
  background:rgba(2,6,23,.6);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:40;
}
#dvd span{
  font-weight:800;
  letter-spacing:.08em;
  background:linear-gradient(120deg,#4ade80,#38bdf8,#a855f7);
  -webkit-background-clip:text;
  color:transparent;
}

/* Layout */
.main{
  max-width:1100px;
  margin:24px auto;
  padding:16px;
}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  box-shadow:var(--shadow);
}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:900px){.grid{grid-template-columns:1fr}}

textarea{
  width:100%;
  min-height:420px;
  background:#020617;
  color:#e6ebff;
  border-radius:14px;
  border:1px solid var(--border);
  padding:14px;
  font-family:var(--mono);
  font-size:13px;
}

button{
  border-radius:999px;
  padding:10px 16px;
  border:none;
  cursor:pointer;
  font-weight:600;
}
.run{
  background:linear-gradient(135deg,#4ade80,#38bdf8,#a855f7);
  color:#020617;
}
.secondary{
  background:transparent;
  border:1px dashed var(--border);
  color:var(--muted);
}

pre{
  background:#020617;
  padding:14px;
  border-radius:14px;
  border:1px solid var(--border);
  white-space:pre-wrap;
}

/* Result cards */
.result{border-radius:16px;padding:14px;border:1px solid rgba(255,255,255,.12)}
.result.ok{background:rgba(34,197,94,.12);border-color:rgba(34,197,94,.35)}
.result.warn{background:rgba(251,191,36,.1);border-color:rgba(251,191,36,.35)}
.result.err{background:rgba(251,113,133,.1);border-color:rgba(251,113,133,.35)}
.resultTitle{font-weight:800;margin-bottom:6px}
.hint{opacity:.75;font-size:12px}

table{width:100%;border-collapse:collapse}
th,td{border:1px solid rgba(255,255,255,.1);padding:8px;font-family:var(--mono)}
th{color:var(--muted);width:140px}

/* Toast */
.toast{
  position:fixed;
  bottom:18px;
  right:18px;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:10px 12px;
  opacity:0;
  transition:.2s;
}
.toast.show{opacity:1}
</style>
</head>

<body>

<div id="dvd"><span>DVD</span></div>
<div class="cursor-glow" id="glow"></div>
<div class="cursor" id="cursor"></div>
<div class="toast" id="toast"></div>

<div class="main">
  <h1>TCSS 142 · Project 1 Tester — Space Needle</h1>

  <div class="grid">
    <div class="card">
      <h3>Paste Project1.java</h3>
      <textarea id="code"></textarea>
      <br><br>
      <button class="run" onclick="runTests()">Run Tests (Ctrl+Enter)</button>
      <button class="secondary" onclick="clearAll()">Clear</button>
    </div>

    <div class="card">
      <h3>Tester Output</h3>
      <div id="out">(waiting)</div>
    </div>
  </div>
</div>

<script>
const codeEl=document.getElementById("code");
const outEl=document.getElementById("out");
const toastEl=document.getElementById("toast");

function toast(msg){
  toastEl.textContent=msg;
  toastEl.classList.add("show");
  setTimeout(()=>toastEl.classList.remove("show"),1600);
}

function escapeHtml(s){
  return (s??"").replace(/[&<>"']/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[c]));
}
function showSpaces(s){
  if(s==="")return"(empty)";
  return escapeHtml(s).replace(/ /g,"·");
}

async function runTests(){
  const res=await fetch("/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:codeEl.value})});
  const text=await res.text();
  renderResult(text);
}

function renderResult(raw){
  if(raw.startsWith("STATUS:PASS")){
    outEl.innerHTML=`<div class="result ok"><div class="resultTitle">✅ PASS</div>Your output matches exactly.</div>`;
    toast("PASS");
    return;
  }
  if(raw.startsWith("STATUS:COMPILE_ERROR")){
    outEl.innerHTML=`<div class="result err"><div class="resultTitle">❌ COMPILE ERROR</div><pre>${escapeHtml(raw)}</pre></div>`;
    toast("Compile error");
    return;
  }
  if(raw.startsWith("STATUS:MISMATCH")){
    const l=raw.match(/LINE:(\d+)/)[1];
    const e=raw.match(/EXPECTED:(.*)/)[1];
    const g=raw.match(/GOT:(.*)/)[1];
    outEl.innerHTML=`
      <div class="result warn">
        <div class="resultTitle">⚠️ Mismatch at line ${l}</div>
        <table>
          <tr><th>Expected</th><td>${showSpaces(e)}</td></tr>
          <tr><th>Your output</th><td>${showSpaces(g)}</td></tr>
        </table>
        <div class="hint">Spacing matters.</div>
      </div>`;
    toast("Mismatch");
    return;
  }
  outEl.textContent=raw;
}

function clearAll(){
  codeEl.value="";
  outEl.textContent="(waiting)";
}

/* Cursor follow */
let mx=0,my=0,cx=0,cy=0;
document.addEventListener("mousemove",e=>{mx=e.clientX;my=e.clientY});
function tick(){
  cx+=(mx-cx)*.18; cy+=(my-cy)*.18;
  cursor.style.left=cx+"px"; cursor.style.top=cy+"px";
  glow.style.left=cx+"px"; glow.style.top=cy+"px";
  requestAnimationFrame(tick);
}
tick();

/* DVD bounce */
const dvd=document.getElementById("dvd");
let x=40,y=80,dx=1.3,dy=1.1;
function bounce(){
  x+=dx;y+=dy;
  if(x<0||x+dvd.offsetWidth>innerWidth)dx*=-1;
  if(y<0||y+dvd.offsetHeight>innerHeight)dy*=-1;
  dvd.style.left=x+"px"; dvd.style.top=y+"px";
  requestAnimationFrame(bounce);
}
bounce();

/* Shortcut */
document.addEventListener("keydown",e=>{
  if((e.ctrlKey||e.metaKey)&&e.key==="Enter"){runTests();e.preventDefault();}
});
</script>

</body>
</html>
