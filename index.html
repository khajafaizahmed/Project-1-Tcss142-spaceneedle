<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TCSS 142 ¬∑ Project 1 Space Needle Tester</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:
    radial-gradient(circle at 15% 20%, #1b3a6f 0%, transparent 40%),
    radial-gradient(circle at 85% 0%, #4c1d95 0%, transparent 45%),
    radial-gradient(circle at 50% 100%, #065f46 0%, transparent 45%),
    #020617;

  --card: rgba(17,24,39,.88);
  --border: rgba(148,163,184,.35);
  --text: #e5e7eb;
  --muted: #9ca3af;

  --green:#22c55e;
  --blue:#38bdf8;
  --purple:#a855f7;
  --yellow:#fbbf24;
  --red:#fb7185;

  --shadow: 0 25px 70px rgba(0,0,0,.75);
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  font-family:Inter,system-ui,sans-serif;
  color:var(--text);
  background:var(--bg);
  cursor:none;
}

/* ================== BLOB CURSOR ================== */
.blob-layer{
  position:fixed;
  inset:0;
  pointer-events:none;
  filter:url(#husky-blob);
  z-index:0;
}
.blob-dot{
  position:absolute;
  border-radius:50%;
  background:radial-gradient(circle at 30% 20%, #b28cff 0, #6a33d9 40%, #32006e 100%);
  box-shadow:0 25px 55px rgba(0,0,0,.85);
  opacity:.85;
  transform:translate(-50%,-50%);
}
.blob-dot:nth-child(1){width:55px;height:55px}
.blob-dot:nth-child(2){width:90px;height:90px}
.blob-dot:nth-child(3){width:120px;height:120px}
.blob-dot:nth-child(4){width:140px;height:140px}
.blob-dot:nth-child(5){width:100px;height:100px}
.blob-dot:nth-child(6){width:70px;height:70px}

/* ================== DVD ================== */
.dvd-layer{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:0;
}
.dvd-x{
  position:absolute;
  width:110px;
  height:66px;
  animation:dvd-x 12s linear infinite alternate;
}
.dvd-y{
  width:110px;
  height:66px;
  animation:dvd-y 8s linear infinite alternate;
}
@keyframes dvd-x{
  from{transform:translateX(0)}
  to{transform:translateX(calc(100vw - 110px))}
}
@keyframes dvd-y{
  from{transform:translateY(0)}
  to{transform:translateY(calc(100vh - 66px))}
}

/* ================== LAYOUT ================== */
.container{
  max-width:1250px;
  margin:28px auto;
  padding:16px;
  position:relative;
  z-index:1;
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom:18px;
}
.header h1{
  margin:0;
  font-size:34px;
}
.header p{
  margin:6px 0 0;
  font-size:14px;
  color:var(--muted);
  max-width:680px;
}
.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  background:linear-gradient(90deg,#22c55e,#38bdf8);
  color:#020617;
  margin-bottom:8px;
}
.meta{
  text-align:right;
  font-size:12px;
  color:var(--muted);
}

.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:18px;
  box-shadow:var(--shadow);
  backdrop-filter:blur(24px);
}

.grid{
  display:grid;
  grid-template-columns:420px 1fr;
  gap:18px;
}
@media(max-width:1000px){
  .grid{grid-template-columns:1fr}
}

/* ================== INFO CARD ================== */
.info-card h2{
  margin-top:0;
  font-size:18px;
}

.info-desc{
  font-size:13px;
  color:var(--muted);
  line-height:1.5;
  margin-bottom:10px;
}

.info-mini-list{
  padding-left:18px;
  margin:0 0 12px;
  font-size:13px;
}
.info-mini-list li{
  margin-bottom:6px;
}

.info-mini-list code{
  background:#020617;
  border:1px solid var(--border);
  border-radius:6px;
  padding:2px 6px;
  font-family:"JetBrains Mono",monospace;
  font-size:12px;
}

/* Pills */
.info-pill-row{
  display:flex;
  flex-direction:column;
  gap:8px;
}

.info-pill{
  display:flex;
  align-items:center;
  gap:10px;
  padding:8px 12px;
  border-radius:999px;
  background:rgba(148,163,184,.08);
  font-size:12px;
}

.bullet{
  width:8px;
  height:8px;
  border-radius:50%;
  background:var(--green);
  box-shadow:0 0 8px rgba(34,197,94,.8);
}
.bullet.info{
  background:var(--blue);
  box-shadow:0 0 8px rgba(56,189,248,.8);
}
.bullet.danger{
  background:var(--red);
  box-shadow:0 0 10px rgba(248,113,113,.9);
}

/* ================== EDITOR ================== */
textarea{
  width:100%;
  height:260px;
  background:#020617;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:14px;
  padding:14px;
  font-family:"JetBrains Mono",monospace;
  font-size:13px;
  resize:vertical;
}

.actions{
  display:flex;
  gap:10px;
  margin-top:10px;
  flex-wrap:wrap;
}
button{
  border:none;
  border-radius:999px;
  padding:8px 18px;
  font-size:13px;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:6px;
}
.run{background:linear-gradient(90deg,#22c55e,#38bdf8);color:#020617}
.clear{background:#374151;color:var(--text)}

.result{
  border-radius:16px;
  padding:16px;
  margin-top:12px;
}
.ok{background:rgba(34,197,94,.15);border:1px solid rgba(34,197,94,.4)}
.warn{background:rgba(251,191,36,.15);border:1px solid rgba(251,191,36,.4)}
.err{background:rgba(251,113,133,.15);border:1px solid rgba(251,113,133,.4)}

pre{
  white-space:pre;
  overflow:auto;
  font-family:"JetBrains Mono",monospace;
  font-size:12px;
}

/* ================== FOOTER NOTE ================== */

.footer-note{
  margin-top:22px;
  padding:12px 16px;
  text-align:center;
  font-size:12px;
  color:var(--muted);
  background:rgba(148,163,184,.06);
  border:1px dashed var(--border);
  border-radius:14px;
}

.footer-note code{
  background:#020617;
  border:1px solid var(--border);
  border-radius:6px;
  padding:2px 6px;
  font-family:"JetBrains Mono",monospace;
  font-size:12px;
}

.footer-note a{
  color:inherit;
  text-decoration:underline;
}

</style>
</head>

<body>

<!-- SVG filter for blob -->
<svg width="0" height="0">
  <filter id="husky-blob">
    <feGaussianBlur stdDeviation="22"/>
    <feColorMatrix values="
      1 0 0 0 0
      0 1 0 0 0
      0 0 1 0 0
      0 0 0 35 -10"/>
  </filter>
</svg>

<!-- Blob -->
<div class="blob-layer">
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
  <div class="blob-dot"></div>
</div>

<!-- DVD -->
<div class="dvd-layer">
  <div class="dvd-x">
    <img class="dvd-y" src="https://vgmoose.bdns.dev/dvd_logo.png">
  </div>
</div>

<div class="container">

  <div class="header">
    <div>
      <div class="badge">üóº SPACE NEEDLE TESTER</div>
      <h1>TCSS 142 ¬∑ Project 1 Strict Tester</h1>
      <p>
        Paste your full <strong>Project1.java</strong>. Output is checked line-by-line
        against the official reference used for grading.
      </p>
    </div>
    <div class="meta">
      TCSS 142 Programming Principles<br>
      Instructor: Prof. Xutong Liu<br>
      TA: Faiz Ahmed
    </div>
  </div>

  <div class="grid">

    <!-- INFO -->
    <div class="card info-card">
      <h2>üß≠ How to use this tester</h2>

      <p class="info-desc">
        Use this page as a quick pre-submit check. A clean run here does not replace
        your own testing, but it helps catch formatting and logic issues that the
        auto-grader cares about.
      </p>

      <ul class="info-mini-list">
        <li>1. Paste the entire contents of <strong>Project1.java</strong> on the right.</li>
        <li>2. Ensure the file contains <code>public class Project1</code>.</li>
        <li>3. Click <em>Run tests</em> or press <kbd>Ctrl</kbd>/<kbd>‚åò</kbd> + <kbd>Enter</kbd>.</li>
        <li>4. Fix the <strong>first mismatch</strong> reported in the output panel.</li>
      </ul>

      <div class="info-pill-row">
        <div class="info-pill">
          <span class="bullet"></span>
          <span>Checks spacing, symbols, and line count exactly</span>
        </div>
        <div class="info-pill">
          <span class="bullet info"></span>
          <span>Highlights formatting problems that cause Canvas failures</span>
        </div>
        <div class="info-pill">
          <span class="bullet danger"></span>
          <span>Reports the first mismatch to keep debugging focused</span>
        </div>
      </div>
    </div>

    <!-- EDITOR -->
    <div class="card">
      <h3>üìÑ Project1.java</h3>
      <textarea id="code" placeholder="// Paste your Project1.java here"></textarea>

      <div class="actions">
        <button class="run" onclick="runTests()">‚ñ∂ Run tests</button>
        <button class="clear" onclick="clearAll()">üßπ Clear</button>
        <span style="font-size:12px;color:var(--muted)">‚å® Ctrl / ‚åò + Enter</span>
      </div>

      <div id="out">(waiting‚Ä¶)</div>
    </div>

  </div>
<div class="footer-note">
  This page runs your code against the official
  <code>Project1.java</code> on the server side.
  If you are stuck or the website is not working, please contact
  <strong>Faiz Ahmed</strong>
  (<a href="mailto:faizahm@uw.edu">faizahm@uw.edu</a>).
</div>

</div>

<script>
const codeEl=document.getElementById("code");
const outEl=document.getElementById("out");

/* Blob motion (UNCHANGED) */
(()=>{
  const dots=[...document.querySelectorAll(".blob-dot")];
  const pts=dots.map(()=>({x:innerWidth/2,y:innerHeight/2}));
  let tx=innerWidth/2, ty=innerHeight/2;
  const speed=[.20,.16,.14,.12,.10,.08];

  function tick(){
    pts[0].x+=(tx-pts[0].x)*speed[0];
    pts[0].y+=(ty-pts[0].y)*speed[0];
    for(let i=1;i<pts.length;i++){
      pts[i].x+=(pts[i-1].x-pts[i].x)*speed[i];
      pts[i].y+=(pts[i-1].y-pts[i].y)*speed[i];
    }
    pts.forEach((p,i)=>{
      dots[i].style.transform=`translate(${p.x}px,${p.y}px) translate(-50%,-50%)`;
    });
    requestAnimationFrame(tick);
  }
  addEventListener("pointermove",e=>{tx=e.clientX;ty=e.clientY});
  tick();
})();

/* ---------- Helpers ---------- */

function esc(s){
  return (s||"").replace(/[&<>]/g,c=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[c]));
}

function parseResponse(t){
  const lines=t.split("\n");
  const d={};
  for(const l of lines){
    const i=l.indexOf(":");
    if(i>0){
      d[l.slice(0,i)] = l.slice(i+1);




    }
  }

  return d;
}

/* ---------- Main actions ---------- */

async function runTests(){
  if(!codeEl.value.trim()){
    outEl.textContent="Paste Project1.java first.";
    return;
  }
  outEl.textContent="Running tests‚Ä¶";
  const r=await fetch("/run",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({code:codeEl.value})
  });
  render(await r.text());
}

function render(t){
  const d=parseResponse(t);

  /* PASS */
  if(d.STATUS==="PASS"){
    outEl.innerHTML=`
      <div class="result ok">
        üéâ <b>PASS</b><br>
        Your output matches the reference exactly.
      </div>`;
    return;
  }

  /* COMPILE ERROR */
  if(d.STATUS==="COMPILE_ERROR"){
    outEl.innerHTML=`
      <div class="result err">
        ‚ùå <b>Compilation error</b>
        <pre>${esc(t)}</pre>
        <div class="info-desc" style="margin-top:8px">
          Fix Java errors before worrying about formatting.
        </div>
      </div>`;
    return;
  }

  /* LINE COUNT */
  if(d.STATUS==="LINE_COUNT"){
    outEl.innerHTML=`
      <div class="result warn">
        üìè <b>Line count mismatch</b><br>
        Expected <b>${d.EXPECTED}</b> lines, but got <b>${d.GOT}</b>.
        <div class="info-desc" style="margin-top:8px">
          This usually means a loop ran too many or too few times.
          Check loop bounds involving <code>SIZE</code>.
        </div>
      </div>`;
    return;
  }

  /* MISMATCH */
  if(d.STATUS==="MISMATCH"){
    const label={
      SPACING:"Spacing error",
      INDENTATION:"Indentation error",
      LENGTH:"Line length error",
      CONTENT:"Symbol/content mismatch"
    }[d.TYPE] || "Output mismatch";

    outEl.innerHTML=`
      <div class="result warn">
        ‚ùå <b>${label}</b><br>
        <span style="color:var(--muted)">
          First mismatch on line <b>${d.LINE}</b>
        </span>

        <table>
          <tr>
            <th>Expected</th>
            <td><pre>${esc(d.EXPECTED)}</pre></td>
          </tr>
          <tr>
            <th>Your output</th>
            <td><pre>${esc(d.GOT)}</pre></td>
          </tr>
        </table>

        <div class="info-desc" style="margin-top:8px">
          üí° ${esc(d.HINT)}
        </div>
      </div>`;
    return;
  }

  /* FALLBACK */
  outEl.innerHTML=`<div class="result warn"><pre>${esc(t)}</pre></div>`;
}

function clearAll(){
  codeEl.value="";
  outEl.textContent="(waiting‚Ä¶)";
}

document.addEventListener("keydown",e=>{
  if((e.ctrlKey||e.metaKey)&&e.key==="Enter"){
    e.preventDefault();
    runTests();
  }
});
</script>


</body>
</html>
